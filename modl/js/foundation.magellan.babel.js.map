{"version":3,"sources":["foundation/foundation.magellan.js"],"names":[],"mappings":"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","file":"foundation.magellan.babel.js","sourcesContent":["'use strict';\n\n!function($) {\n\n/**\n * Magellan module.\n * @module foundation.magellan\n */\n\nclass Magellan {\n  /**\n   * Creates a new instance of Magellan.\n   * @class\n   * @fires Magellan#init\n   * @param {Object} element - jQuery object to add the trigger to.\n   * @param {Object} options - Overrides to the default plugin settings.\n   */\n  constructor(element, options) {\n    this.$element = element;\n    this.options  = $.extend({}, Magellan.defaults, this.$element.data(), options);\n\n    this._init();\n\n    Foundation.registerPlugin(this, 'Magellan');\n  }\n\n  /**\n   * Initializes the Magellan plugin and calls functions to get equalizer functioning on load.\n   * @private\n   */\n  _init() {\n    var id = this.$element[0].id || Foundation.GetYoDigits(6, 'magellan');\n    var _this = this;\n    this.$targets = $('[data-magellan-target]');\n    this.$links = this.$element.find('a');\n    this.$element.attr({\n      'data-resize': id,\n      'data-scroll': id,\n      'id': id\n    });\n    this.$active = $();\n    this.scrollPos = parseInt(window.pageYOffset, 10);\n\n    this._events();\n  }\n\n  /**\n   * Calculates an array of pixel values that are the demarcation lines between locations on the page.\n   * Can be invoked if new elements are added or the size of a location changes.\n   * @function\n   */\n  calcPoints() {\n    var _this = this,\n        body = document.body,\n        html = document.documentElement;\n\n    this.points = [];\n    this.winHeight = Math.round(Math.max(window.innerHeight, html.clientHeight));\n    this.docHeight = Math.round(Math.max(body.scrollHeight, body.offsetHeight, html.clientHeight, html.scrollHeight, html.offsetHeight));\n\n    this.$targets.each(function(){\n      var $tar = $(this),\n          pt = Math.round($tar.offset().top - _this.options.threshold);\n      $tar.targetPoint = pt;\n      _this.points.push(pt);\n    });\n  }\n\n  /**\n   * Initializes events for Magellan.\n   * @private\n   */\n  _events() {\n    var _this = this,\n        $body = $('html, body'),\n        opts = {\n          duration: _this.options.animationDuration,\n          easing:   _this.options.animationEasing\n        };\n    $(window).one('load', function(){\n      if(_this.options.deepLinking){\n        if(location.hash){\n          _this.scrollToLoc(location.hash);\n        }\n      }\n      _this.calcPoints();\n      _this._updateActive();\n    });\n\n    this.$element.on({\n      'resizeme.zf.trigger': this.reflow.bind(this),\n      'scrollme.zf.trigger': this._updateActive.bind(this)\n    }).on('click.zf.magellan', 'a[href^=\"#\"]', function(e) {\n        e.preventDefault();\n        var arrival   = this.getAttribute('href');\n        _this.scrollToLoc(arrival);\n    });\n  }\n\n  /**\n   * Function to scroll to a given location on the page.\n   * @param {String} loc - a properly formatted jQuery id selector. Example: '#foo'\n   * @function\n   */\n  scrollToLoc(loc) {\n    var scrollPos = Math.round($(loc).offset().top - this.options.threshold / 2 - this.options.barOffset);\n\n    $('html, body').stop(true).animate({ scrollTop: scrollPos }, this.options.animationDuration, this.options.animationEasing);\n  }\n\n  /**\n   * Calls necessary functions to update Magellan upon DOM change\n   * @function\n   */\n  reflow() {\n    this.calcPoints();\n    this._updateActive();\n  }\n\n  /**\n   * Updates the visibility of an active location link, and updates the url hash for the page, if deepLinking enabled.\n   * @private\n   * @function\n   * @fires Magellan#update\n   */\n  _updateActive(/*evt, elem, scrollPos*/) {\n    var winPos = /*scrollPos ||*/ parseInt(window.pageYOffset, 10),\n        curIdx;\n\n    if(winPos + this.winHeight === this.docHeight){ curIdx = this.points.length - 1; }\n    else if(winPos < this.points[0]){ curIdx = 0; }\n    else{\n      var isDown = this.scrollPos < winPos,\n          _this = this,\n          curVisible = this.points.filter(function(p, i){\n            return isDown ? p <= winPos : p - _this.options.threshold <= winPos;//&& winPos >= _this.points[i -1] - _this.options.threshold;\n          });\n      curIdx = curVisible.length ? curVisible.length - 1 : 0;\n    }\n\n    this.$active.removeClass(this.options.activeClass);\n    this.$active = this.$links.eq(curIdx).addClass(this.options.activeClass);\n\n    if(this.options.deepLinking){\n      var hash = this.$active[0].getAttribute('href');\n      if(window.history.pushState){\n        window.history.pushState(null, null, hash);\n      }else{\n        window.location.hash = hash;\n      }\n    }\n\n    this.scrollPos = winPos;\n    /**\n     * Fires when magellan is finished updating to the new active element.\n     * @event Magellan#update\n     */\n    this.$element.trigger('update.zf.magellan', [this.$active]);\n  }\n\n  /**\n   * Destroys an instance of Magellan and resets the url of the window.\n   * @function\n   */\n  destroy() {\n    this.$element.off('.zf.trigger .zf.magellan')\n        .find(`.${this.options.activeClass}`).removeClass(this.options.activeClass);\n\n    if(this.options.deepLinking){\n      var hash = this.$active[0].getAttribute('href');\n      window.location.hash.replace(hash, '');\n    }\n\n    Foundation.unregisterPlugin(this);\n  }\n}\n\n/**\n * Default settings for plugin\n */\nMagellan.defaults = {\n  /**\n   * Amount of time, in ms, the animated scrolling should take between locations.\n   * @option\n   * @example 500\n   */\n  animationDuration: 500,\n  /**\n   * Animation style to use when scrolling between locations.\n   * @option\n   * @example 'ease-in-out'\n   */\n  animationEasing: 'linear',\n  /**\n   * Number of pixels to use as a marker for location changes.\n   * @option\n   * @example 50\n   */\n  threshold: 50,\n  /**\n   * Class applied to the active locations link on the magellan container.\n   * @option\n   * @example 'active'\n   */\n  activeClass: 'active',\n  /**\n   * Allows the script to manipulate the url of the current page, and if supported, alter the history.\n   * @option\n   * @example true\n   */\n  deepLinking: false,\n  /**\n   * Number of pixels to offset the scroll of the page on item click if using a sticky nav bar.\n   * @option\n   * @example 25\n   */\n  barOffset: 0\n}\n\n// Window exports\nFoundation.plugin(Magellan, 'Magellan');\n\n}(jQuery);\n"]}